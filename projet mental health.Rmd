---
title: "Analyse des jours de maladie mentale de la population en USA."
author: "LEFHAL YOUSSEF"
date: "24/01/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:





I. Données:




Dans une étude observationnelle, les données sont collectées d'une manière qui ne touche pas directement le mode dont les données surviennent. Cette étude établit et infère une relation corrélation (association) entre les variables explicatives et les variables de réponse et pas une relation de causalité.

un exemple d une etude observationnelle est le système de surveillance des facteurs de risque comportemental (BRFSS) efectué en 1984 par les Centers for Disease Control and Prevention (CDC) ,en se basant sur l état, une enquête téléphonique est utilisé pour collecter des données de prévalence parmi les résidents adultes des états-Unis concernant leurs comportements à risque et leurs pratiques de santé préventive qui peuvent affecter leur état de santé.






II. Questions de recherches:



  Presentation du problématique:

Créé en 1984 avec 15 états, BRFSS collecte désormais des données dans les 50 états ainsi que dans le   District de Columbia et trois territoires américains. Le BRFSS réalise plus de 400 000 entretiens avec des adultes chaque  année, ce qui en fait le plus grand système d enquêtes sur la santé mené en continu au monde. Mental health ou bien la santé mentale était l un des sujets de ces enquêtes qui traite 3 grandes parties : les Jours récents de mauvaise santé mentale chez les adultes âgés de >= 18 ans , les 14 jours récents au moins de mauvaise santé mentale chez les femmes âgées de 18 à 44 ans et les SymptÃ´mes dépressifs post-partum. Donc on peut manipuler comme trois questions principales :  quelle est la relation entre la maladie mentale et le sexe ? , comment se développe les jours récents de mauvaise santé mentale chez les femmes âgées de 18 à 44 ans selon leur race ? , est ce qu'il y'a une relation entre le nombre de jours récents de mauvaise santé mentale chez les femmes et le nombre des symptÃ´mes dépressifs  post-partum trouvés ? 









III. Solutions :  


```{r}
# pacakdges utilisés :

library(dplyr) 
library(ggpubr) 
library(ggplot2) 
library(stats)
library(readxl)
```




1/ Quelle est la relation entre la maladie mentale et le sexe ?


  #Etude Theoriques :

  
```{r}
#importer la base de donnée ExportCSV_4_ et le renommer en "age_gender":



age_gender <- read_excel("C:/Users/DELL/Desktop/R en coursera/ExportCSV (4).xlsx")
           
head(age_gender)
 
#je l'ai renommé pour faciliter l'écriture des commandes
```


```{r}
#Créer une base de donnée age_gender en se basant sur les ex datas de cette table et le déviser en 2 tables selon le sexe :

age_gender <- age_gender %>% select("LocationDesc","Stratification1","Data_Value","Low_Confidence_Limit","High_Confidence_Limit")
age_gender1 <- age_gender %>% filter (Stratification1 == "Male")
age_Male = age_gender1
age_Female <- age_gender %>% filter (Stratification1 == "Female")

#suprimer les valeurs "NA":

age_Female <- age_Female %>% filter(Data_Value != "NA")
 age_Male <- age_Male  %>% filter( Data_Value!= "NA")

#calculer la médiane et l'écart type selon le sexe:

male = as.numeric(age_Male$Data_Value)
female = as.numeric(age_Female$Data_Value)
age_Male %>% summarize (mean_boy = mean(male),sd_boy = sd(male), med_boy = median(male), n= n())
 age_Female %>% summarize (mean_girl= mean(female),sd_girl = sd(female), med_girl = median(female), n= n())

```

#interprétation des résultats obtenus :

-> pour le sexe masculin : 
           
  on a mean_boy = 3.788679 ,sd_boy = 0.515  et med_boy = 3.7 jours , cela veut dire que en moyenne les hommes agées plus de 18 ans connaissent 3.7886 jours de maladie mentale et 50 % de ces hommes connaissent 3.7 Jours récents de mauvaise santé mentale.
            
-> pour le sexe Féminin : 
            
  on a mean_girl = 5.224528, sd_girl = 0.73  et med_girl = 5.3 jours , cela veut dire que en moyenne les femmes agées plus de 18 ans connaissent 5.22 jours de maladie mentale et 50 % de ces femmes connaissent 5.3 Jours récents de mauvaise santé mentale.           

-> pour les deux  :
    
   on remarque alors que en moyenne les femmes connaissent des jours de mauvaise santé mentale plus que les hommes, de même les jours des femmes sont plus dispersées que des hommes. 



# Etude Graphique :


```{r}
#regrouper les variables :

 a= age_Male$Data_Value
          b = age_Female$Data_Value
          c <- c(1:53)
          df2 <- data.frame(a,b,c)
          ggplot(df2, aes(x=c)) + 
          geom_line(aes(y = a), color = "darkred") + 
          geom_line(aes(y = b), color="steelblue", linetype="twodash") 
          
          library(tidyr)
          library(tidyselect)
          df <- df2 %>%
          dplyr::select(c, a, b) %>%
          gather(key = "variable", value = "value", -c) 
          

```

```{r}
## traÃ§age :

ggplot(df, aes(x = c, y = value)) + 
geom_line(aes(color = variable, linetype = variable)) 

```

#Interprétation:


 on remarque d aprés le graphe que la plupart des femmmes connaissent un intervalle des jours de maladie mentale de [4.3; 6.1], et les hommes de [3.3 ; 4.8].

 Donc on constate que les jours de maladie mentales pour les femmes sont plus élevées à celles des hommes.
          

#conclusion :


 D après les études Théorique et Graphoique, on constate que les femmes agées plus que 18 ans sont plus sensibles au maladies mentales que les hommes , tel que leurs jours de mauvaise santé mentale sont plus élevés que celles des hommes.







2/ Comment se développe les jours récents de mauvaise santé mentale chez les femmes âgées de 18 à 44 ans selon leur race ? :




```{r}
#Etude graphique:

# importer les données:

 white <- read_excel("C:/Users/DELL/Desktop/R en coursera/white.xlsx")
 black <- read_excel("C:/Users/DELL/Desktop/R en coursera/black.xlsx")
 Hispanic <- read_excel("C:/Users/DELL/Desktop/R en coursera/Hispanic.xlsx")
Other_non_Hispanic<- read_excel("C:/Users/DELL/Desktop/R en coursera/Other, non-Hispanic.txt.xlsx")
Multiracial_non_Hispanic <- read_excel("C:/Users/DELL/Desktop/R en coursera/Multiracial, non-Hispanic.xlsx")

        
#Ajouter des variables :

loc = Other_non_Hispanic$LocationAbbr
w = white$Data_Value
B = black$Data_Value
h = Hispanic$Data_Value
mh = Multiracial_non_Hispanic$Data_Value
onh = Other_non_Hispanic$Data_Value

#regrouper les variables en supprimant les NA :

dfr <- data.frame(loc,w, B,h,mh,onh)
dfr <- dfr %>% filter( w !="NA" , B !="NA", h !="NA" , mh !="NA", onh !="NA" )
          
```



```{r}
# traÃ§age : 

#les jours de la race blanc par rapport au location :
     
ggplot(data = dfr)+
geom_col(mapping = aes(x = loc,y=w))+
labs(
  x = "location",
  y = "jours"
           ) 
```

```{r}
#les jours de la race noir par rapport au location :

ggplot(data = dfr)+
geom_col(mapping = aes(x = loc,y=B))+
labs(
  x = "location",
  y = "jours"
            ) 
```

```{r}
#les jours de la race Hispanic par rapport au location :             
ggplot(data = dfr)+
geom_col(mapping = aes(x = loc,y=h))+
labs(
  x = "location",
  y = "jours"
            ) 
```

```{r}
 #les jours de la race Multiracial_non_Hispanic  par rapport au location : 

ggplot(data = dfr)+
geom_col(mapping = aes(x = loc,y=mh))+
labs(
  x = "location",
  y = "jours"
            ) 
```

```{r}
 #les jours de la race Other_non_Hispanic  par rapport au location : 

ggplot(data = dfr)+
geom_col(mapping = aes(x = loc,y=onh))+
labs(
  x = "location",
  y = "jours"
            ) 
```


```{r}
dfr3 <- data.frame(x = dfr$loc,
                   
  # Reshape data frame
  
y = c(dfr$w, dfr$B,dfr$h,dfr$mh,dfr$onh),
group = c(rep("White", nrow(dfr)),
          rep("Black", nrow(dfr)),
         rep("Hispanic", nrow(dfr)),
        rep("Multiracial_non_Hispanic", nrow(dfr)),
        rep("Other_non_Hispanic", nrow(dfr))))

# Create ggplot2 plot

ggp <- ggplot(dfr3, aes(x, y, fill = group)) +        
 geom_col(position="dodge", stat="identity") 

ggp
```

#Etude Analytique:


```{r}


wh=as.numeric(dfr$w)
bl=as.numeric(dfr$B)
hi=as.numeric(dfr$h)
mh=as.numeric(dfr$mh)
oth=as.numeric(dfr$onh)

## calculer la moyenne :

mean (wh)
mean (bl)
mean (hi)
mean (mh)
mean (oth)
```

```{r}
#calculer la médiane: 
median (wh)
median(bl)
median(hi)
median(mh)
median(oth)
```


 # remarque :

  D'après les calcules de la moyenne et la médiane des datas des races représentés dans la table dfr on constate que : 


 -> pour la race blanc, on a la moyenne = 17.68  et la mediane = 17.7 jours , cela veut dire que 50 % des femme blancs agées entre 18 et 44 ansconnaissent 17.7 Jours récents de mauvaise santé mentale. Et en moyenne les femmes blancs atteignent 17.68 jours de maladie mentales.

  
-> Pour la race noir, on a la moyenne = 16.78  et la mediane = 15.7 jours , cela veut dire que 50 % des femme noirs agées entre 18 et 44 ansconnaissent 15.7 Jours récents de mauvaise santé mentale. Et en moyenne les femmes noirs atteignent 16.78 jours de maladie mentales.
  

-> pour la race Hispanic, on a la moyenne = 13.72 et la mediane = 12.7 jours , cela veut dire que 50 % des femme blancs agées entre 18 et 44 ansconnaissent 12.7 Jours récents de mauvaise santé mentale. Et en moyenne les femmes blancs atteignent 13.72 jours de maladie mentales.
   
     
-> pour la race Multiracial_non_Hispanic, on a la moyenne = 25.15  et la mediane = 22.4 jours , cela veut dire que 50 % des femme blancs agées entre 18 et 44 ansconnaissent 22.4 Jours récents de mauvaise santé mentale. Et en moyenne les femmes blancs atteignent 25.15 jours de maladie mentales.
  
        
-> pour le reste non hispanic, on a la moyenne = 14.76  et la mediane = 14.4 jours , cela veut dire que 50 % des femme blancs agées entre 18 et 44 ansconnaissent 14.4 Jours récents de mauvaise santé mentale. Et en moyenne les femmes blancs atteignent 14.76 jours de maladie mentales.
        



# interprétation :


 Donc on constate que 'l étude analytique' montre ce qu on a élaboré dans "l étude graphique" et que les femmes hispanic sont moins sensibles au maladie mentale, puisque leurs jours de la maladie sont moins élevés par rapport au autre races. Et que les multiracial_ non_ hispanic femmes âgées de 18 -44 ans connaissent, dans la plupart des location citées, des jours de maladie mentale plus élevés que le reste des races. 



# Conclusion :


il exciste une relation entre les races des femmes agées entre 18 et 45 ans et leurs jours de maladie mentale, tel que on trouve que "les femmes mutiracial_non_hispanic" connaissent des jours plus élevés que les autre, suivant "des femmes de la race blanc ", puis "les femmes de la race noir", ensuite "celles de la race non hispanic " et enfin on trouve "les femmes hispanics" avec la plus moindre nombre de jours de maladie mentale. 





3/ Est ce qu'il y'a une relation entre le nombre de jours récents de mauvaise santé mentale chez les femmes et le nombre des symptÃ´mes dépressifs  post-partum trouvés ? 

 
```{r}

#importation des datas et suprimer les NA :

symptoms<- read_excel("C:/Users/DELL/Desktop/R en coursera/assymp.xlsx")
femmes_18 <- read_excel("C:/Users/DELL/Desktop/R en coursera/femme11.xlsx")
femmes_18<- femmes_18 %>% slice(-73)

symp = as.numeric(symptoms$Data_Value)
femmes = as.numeric(femmes_18$Data_Value)
abloc = c(symptoms$LocationAbbr)
symp_femmes = data_frame(abloc,femmes,symp)

# supprimer les NA : 
symp_femmes <- symp_femmes %>% filter(femmes!="NA",symp != "NA")

# graphe par plots : 

ggplot(data= symp_femmes, aes(x=femmes,y=symp))+ geom_line()

x= c(symp_femmes$abloc)
y1 = as.numeric(symp_femmes$femmes)
y2 = as.numeric(symp_femmes$symp)
dfr4 <- data.frame(x,y1,y2)
                     
```

```{r}
dfr5 <- data.frame(x = dfr4$x,                            
  # Reshape data frame
  y = c(dfr4$y1, dfr4$y2),
  group1 = c(rep("femmes", nrow(dfr4)),
    rep("symptoms", nrow(dfr4))))

ggp5 <- ggplot(dfr5, aes(x, y, fill = group1)) +             
  # Create ggplot2 plot
 geom_col(position="dodge", Stat ="identity") 

ggp5
```

```{r}
# Graphe linéaire: 

dfr4 <- dfr4 %>% mutate(num=c(1:23))
df <- dfr4 %>%
  dplyr::select(num, y1, y2) %>%
  gather(key = "variable", value = "value", -num)
GG <- ggplot(df, aes(x = num, y = value)) + 
  geom_line(aes(color = variable, linetype = variable)) + 
  scale_color_manual(values = c("darkred", "steelblue"))
GG <- GG + ylab("jours") + xlab("num de locations")
GG
```


# Interprétation:

 Donc on remarque d'après ces graphes que, dans la plupart des locations , il y'a une relation d'equivalence entre le nombres de jours de maladie mentale des femmes agées de 18 à 45 ans (d'aprés les statistiques de 2011 ) et le nombre des SymptÃ´mes dépressifs post-partum. Tel que la réduction de nombre de jours de la maladie implique une réduction des symptÃ´mes, sauf en utah, oÃ¹ on trouve le contraire.


# conclusion :

 On peut conclure l'excistence d'une relation d'equivalence et d'indépendance entre le nombres de jours de maladie mentale des femmes agées de 18 à 45 ans (d'aprés les statistiques de 2011 ) et le nombre des SymptÃ´mes dépressifs post-partum, et que le fait d'avoir trop de nombre des SymptÃ´mes dépressifs post-partum implique une augmentation des jours de maladie mentale chez les femmes âgées de 15 à 45 ans.


